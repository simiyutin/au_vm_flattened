int x1;
int y;
int z;

function int foo(int x) {
    print('foo start, x=', x, '\n');
    int r;
    function int bar(int a) {
        print('bar start, a=', a, '\n');
        if (a <= 0) {
            print('bar early leave\n');
            return z;
        }
        print('calling baz, a=', a, '\n');
        x = baz();
        print('called baz, a=', a, '\n');
        r += 1;
        print('calling bar recursively, a=', a, ' x=', x, 'z=', z, '\n');
        return x + bar(a - 1);
    }
    function int baz() {
        print('baz start\n');
        int s;
        function int bak(int z1) {
            print('bak start, z1=', z1, '\n');
            if (z1 <= 0) {
                x = z1;
            } else {
                y = z1 + 1;
                x = -z1;
            }
            x -= 1;
            int t;
            t = baz();
            t -= 1;
            if (s < 0) {
                s = s * -1;
            }
            x += 1;
            return t + z1 + bar(z1 - y);
        }
        if (x <= 0 || y <= 0 || z <= 0) { // @1:0, @2:2, @2:3
            print('baz early leave\n');
            return x + y + z;
        }
        s = foo(x - 1);
        y += s;
        z = bak(z - y + 1);
        z -= 2;
        return s + bar(x);
    }
    if (x == 0) {
        int f;
        f = baz();
        return bar(f - 3);
    }
    r = foo(x - 1);
    bar(r); // when x == 1 r will be 7
    return r + baz();
}

x1 = 2;
y = 2;
z = 2;

print(foo(2), '\n');
print(x1, '\n', y, '\n', z, '\n');
